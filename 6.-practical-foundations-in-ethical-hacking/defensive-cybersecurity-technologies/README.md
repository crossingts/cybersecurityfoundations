---
description: >-
  This section covers important defensive security technologies such as packet
  analyzers, intrusion detection/intrusion prevention, SIEM, and firewalls
---

# Defensive cybersecurity technologies

• Describe common defensive security technologies such as packet analyzers (e.g., Wireshark), IDS/IPS (e.g., Suricata and Snort), network security monitoring/SIEM (e.g., Wazuh), and host/network firewalls (e.g., OPNsense, pfilter, and nftables).

#### Wireshark

Wireshark is primarily a defensive (security monitoring) tool, but it can also be used in offensive security (ethical hacking) scenarios.

**Wireshark Defensive Uses:**

1. **Traffic Analysis for Security Monitoring**
   * Wireshark’s core function is capturing and analyzing network traffic, which is essential for detecting anomalies, intrusions, and malicious activity (e.g., malware C2 traffic, suspicious connections).
   * Security teams use it to inspect packets for signs of attacks (e.g., port scans, unusual protocols, data exfiltration).
2. **Incident Response & Forensics**
   * After a breach, analysts use Wireshark to review packet captures (PCAPs) to understand attack vectors, lateral movement, and data leaks.
   * It helps reconstruct events by examining raw network data.
3. **Network Troubleshooting (Non-Attack Use Cases)**
   * IT admins and defenders use Wireshark to diagnose connectivity issues, misconfigurations, and performance problems—not just security threats.
4. **Passive Tool (No Active Exploitation)**
   * Wireshark doesn’t send packets or exploit vulnerabilities; it only observes traffic. Offensive tools (e.g., Metasploit, Nmap) actively interact with targets.

**Wireshark Offensive Uses (Secondary Role):**

While defensive use is primary, ethical hackers and attackers can leverage Wireshark for:

* **Reconnaissance**: Capturing unencrypted credentials, session tokens, or sensitive data in transit.
* **Man-in-the-Middle (MITM) Analysis**: Inspecting traffic during red-team engagements (e.g., ARP spoofing attacks).
* **Protocol Reverse-Engineering**: Studying proprietary protocols for vulnerabilities.

However, these offensive uses typically require additional tools (e.g., Ettercap, BetterCAP) to actively manipulate traffic—Wireshark alone is just the analyzer.

Wireshark is **defensive-first** because its primary purpose is monitoring, analysis, and defense. Its core value lies in visibility—whether for protecting or probing a network.

Here’s a concise table summarizing Wireshark’s dual-use capabilities in **defensive (security monitoring)** and **offensive (ethical hacking)** contexts:

| **Category**         | **Defensive Use (Security Monitoring)**                                                                                                              | **Offensive Use (Ethical Hacking)**                                                                                                          |
| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
| **Primary Role**     | Traffic inspection, threat detection, and incident response.                                                                                         | Reconnaissance, protocol analysis, and attack validation.                                                                                    |
| **Key Functions**    | <p>- Detect malware C2 traffic.<br>- Analyze intrusion attempts.<br>- Troubleshoot network issues.<br>- Forensic investigations (PCAP analysis).</p> | <p>- Capture unencrypted credentials.<br>- Analyze MITM attack results.<br>- Reverse-engineer protocols.<br>- Validate exploit payloads.</p> |
| **Tool Interaction** | Used alongside SIEMs, IDS/IPS (e.g., Snort), and firewalls.                                                                                          | Paired with exploitation tools (e.g., Metasploit, Responder).                                                                                |
| **Activity Type**    | **Passive**: Observes traffic without modification.                                                                                                  | **Supportive**: Analyzes traffic generated by active attacks.                                                                                |
| **Examples**         | <p>- Identifying a ransomware beacon.<br>- Investigating a data exfiltration attempt.</p>                                                            | <p>- Sniffing FTP credentials.<br>- Debugging a custom exploit's network behavior.</p>                                                       |

#### nftables firewall to optimize traffic flow

• Default to connection denial for inbound traffic

• Limit accessible ports and hosts with an allow list

#### Wazuh (SIEM) as a network security monitoring tool

Wazuh is primarily a SIEM and HIDS tool with log analysis and file integrity monitoring capabilities, great for centralized visibility and incident response.

* It collects and correlates logs from multiple sources (network devices, servers, cloud services).
* It does not replace a traditional NIDS like Suricata but can integrate with them—IDS provides raw threat data, while SIEM helps make sense of IDS alerts.
* It provides compliance monitoring (e.g., PCI DSS, GDPR) and incident response features.

The Wazuh Security Information and Event Management (SIEM) solution is a centralized platform for aggregating and analyzing telemetry in real time for threat detection and compliance. Wazuh collects event data from various sources like endpoints, network devices, cloud workloads, and applications for broader security coverage. (wazuh.com)

The Wazuh Extended Detection and Response (XDR) platform provides a comprehensive security solution that detects, analyzes, and responds to threats across multiple IT infrastructure layers. Wazuh collects telemetry from endpoints, network devices, cloud workloads, third-party APIs, and other sources for unified security monitoring and protection. (wazuh.com)

#### **Comparison Table: SIEM vs. IDS/IPS vs. Firewalls vs. EDR**

| Feature                   | **SIEM (Wazuh, Splunk)**              | **IDS/IPS (Snort, Suricata)**           | **Firewall (nftables, iptables, pfSense)** | **EDR (CrowdStrike, Wazuh EDR)**             |
| ------------------------- | ------------------------------------- | --------------------------------------- | ------------------------------------------ | -------------------------------------------- |
| **Primary Role**          | Log correlation, alerting, compliance | Detect/block malicious traffic          | Filter traffic based on rules              | Detect/respond to endpoint threats           |
| **Detection Method**      | Rule-based + anomaly (if configured)  | Signature + anomaly detection           | Rule-based (allow/deny)                    | Behavioral analysis + threat intelligence    |
| **Prevention Capability** | No (alerting only)                    | **IPS can block**, IDS alerts           | **Blocks traffic** based on rules          | **Can block processes**, isolate hosts       |
| **Data Source**           | Logs (network, endpoints, apps)       | Network traffic (packet **inspection**) | Network traffic (L3/L4 **filtering**)      | Endpoint processes, memory, files            |
| **Scope**                 | Broad (entire infrastructure)         | Network-focused                         | Network perimeter/internal segmentation    | Endpoint-focused (workstations, servers)     |
| **Best For**              | Incident investigation, compliance    | Real-time threat blocking               | Access control, network segmentation       | Advanced malware, lateral movement detection |

A mature security stack combines:

1. **Firewall** → Blocks unauthorized access.
2. **IDS/IPS** → Stops known attacks in traffic.
3. **NTA** → Detects stealthy threats in network flows.
4. **SIEM** → Correlates alerts from all sources.
5. **EDR** → Hunts for endpoint compromises.
